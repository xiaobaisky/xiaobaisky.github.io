function initializeCard(){cardTimes(),cardRefreshTimes()}let year,month,week,date,dates,weekStr,monthStr,asideTime,asideDay,asideDayNum,animalYear,ganzhiYear,lunarMon,lunarDay;document.addEventListener("DOMContentLoaded",(()=>{initializeCard()})),document.addEventListener("pjax:complete",(()=>{initializeCard()}));const now=new Date;function cardRefreshTimes(){const e=document.getElementById("card-widget-schedule");e&&(asideDay=(now-asideTime)/1e3/60/60/24,e.querySelector("#pBar_year").value=asideDay,e.querySelector("#p_span_year").innerHTML=(asideDay/365*100).toFixed(1)+"%",e.querySelector(".schedule-r0 .schedule-d1 .aside-span2").innerHTML=`还剩<a> ${(365-asideDay).toFixed(0)} </a>天`,e.querySelector("#pBar_month").value=date,e.querySelector("#pBar_month").max=dates,e.querySelector("#p_span_month").innerHTML=(date/dates*100).toFixed(1)+"%",e.querySelector(".schedule-r1 .schedule-d1 .aside-span2").innerHTML=`还剩<a> ${dates-date} </a>天`,e.querySelector("#pBar_week").value=0===week?7:week,e.querySelector("#p_span_week").innerHTML=((0===week?7:week)/7*100).toFixed(1)+"%",e.querySelector(".schedule-r2 .schedule-d1 .aside-span2").innerHTML=`还剩<a> ${7-(0===week?7:week)} </a>天`)}function cardTimes(){year=now.getFullYear(),month=now.getMonth(),week=now.getDay(),date=now.getDate();const e=document.getElementById("card-widget-calendar");if(e){weekStr=["周日","周一","周二","周三","周四","周五","周六"][week];const a=[{month:"1月",days:31},{month:"2月",days:year%4==0&&year%100!=0||year%400==0?29:28},{month:"3月",days:31},{month:"4月",days:30},{month:"5月",days:31},{month:"6月",days:30},{month:"7月",days:31},{month:"8月",days:31},{month:"9月",days:30},{month:"10月",days:31},{month:"11月",days:30},{month:"12月",days:31}];monthStr=a[month].month,dates=a[month].days;const t=(week+8-date%7)%7;let n="",r=!1,d=7-t;const o=(dates-d)%7==0?Math.floor((dates-d)/7)+1:Math.floor((dates-d)/7)+2,s=e.querySelector("#calendar-main");e.querySelector("#calendar-date").style.fontSize=["64px","48px","36px"][Math.min(o-3,2)];for(let e=0;e<o;e++){s.querySelector(`.calendar-r${e}`)||(s.innerHTML+=`<div class='calendar-r${e}'></div>`);for(let a=0;a<7;a++){0===e&&a===t&&(n=1,r=!0);const d=n===date?" class='now'":"";s.querySelector(`.calendar-r${e} .calendar-d${a} a`)||(s.querySelector(`.calendar-r${e}`).innerHTML+=`<div class='calendar-d${a}'><a${d}>${n}</a></div>`),n>=dates&&(n="",r=!1),r&&(n+=1)}}const i=chineseLunar.solarToLunar(new Date(year,month,date));animalYear=chineseLunar.format(i,"A"),ganzhiYear=chineseLunar.format(i,"T").slice(0,-1),lunarMon=chineseLunar.format(i,"M"),lunarDay=chineseLunar.format(i,"d");const l=new Date("2026/02/16 00:00:00"),c=Math.floor((l-now)/1e3/60/60/24);asideTime=new Date(`${(new Date).getFullYear()}/01/01 00:00:00`),asideDay=(now-asideTime)/1e3/60/60/24,asideDayNum=Math.floor(asideDay);const u=week-asideDayNum%7>=0?Math.ceil(asideDayNum/7):Math.ceil(asideDayNum/7)+1;e.querySelector("#calendar-week").innerHTML=`第${u}周&nbsp;${weekStr}`,e.querySelector("#calendar-date").innerHTML=date.toString().padStart(2,"0"),e.querySelector("#calendar-solar").innerHTML=`${year}年${monthStr}&nbsp;第${asideDay.toFixed(0)}天`,e.querySelector("#calendar-lunar").innerHTML=`${ganzhiYear}${animalYear}年&nbsp;${lunarMon}${lunarDay}`,document.getElementById("schedule-days").innerHTML=c}}function initializeHot(){const e=document.getElementById("card-hotpost");e&&fetch("https://api.haiskyblog.top/hot/").then((e=>e.json())).then((a=>{let t=0;a.forEach((a=>{t++;const n=document.createElement("a");n.classList.add("hot-post-link"),n.setAttribute("href",a.url),n.innerHTML=`<span class="post-rank rank-${1==t?"1":"2"}">${t}</span><div class="post-title-container"><span class="post-title">${a.title}</span></div>`,e.appendChild(n)}))}))}document.addEventListener("DOMContentLoaded",(()=>{initializeHot()})),document.addEventListener("pjax:complete",(()=>{initializeHot()}));