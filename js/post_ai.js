class AIPostRenderer{static ANIMATION_DELAY_MS=30;static AI_EXPLANATION_SELECTOR=".ai-explanation";static AI_TAG_SELECTOR=".ai-tag";constructor(){this.startTextAnimation=this.startTextAnimation.bind(this),this.animationFrame=null}init(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",this.initialize.bind(this)):this.initialize()}initialize(){this.cacheElements(),this.validateContent()&&this.renderAIContent()}cacheElements(){this.refs=new WeakMap,this.refs.set(document,{explanationElement:document.querySelector(AIPostRenderer.AI_EXPLANATION_SELECTOR),tagElement:document.querySelector(AIPostRenderer.AI_TAG_SELECTOR)});const{explanationElement:t,tagElement:e}=this.refs.get(document)||{};this.explanationElement=t,this.tagElement=e}validateContent(){return!(!(this.explanationElement&&this.tagElement&&this.aiContent.length)||this.isAnimating)}renderAIContent(){this.prepareAnimation(),this.animationFrame=requestAnimationFrame((()=>this.startTextAnimation(0)))}prepareAnimation(){this.isAnimating=!0,this.tagElement.classList.add("loadingAI"),this.explanationElement.textContent=""}startTextAnimation(t){t>=this.aiContent.length?this.completeAnimation():(this.appendCharacter(this.aiContent[t]),this.animationFrame=requestAnimationFrame((()=>this.startTextAnimation(t+1))))}appendCharacter(t){this.fragment||(this.fragment=document.createDocumentFragment());const e=document.createElement("span");e.className="char",e.textContent=t,this.fragment.appendChild(e),this.fragment.childNodes.length%1==0&&(this.explanationElement.appendChild(this.fragment),this.fragment=null)}completeAnimation(){this.fragment&&(this.explanationElement.appendChild(this.fragment),this.fragment=null),cancelAnimationFrame(this.animationFrame),this.isAnimating=!1,this.tagElement.classList.remove("loadingAI");const t=new CustomEvent("aiRenderComplete",{detail:{element:this.explanationElement}});document.dispatchEvent(t)}get aiContent(){return PAGE_CONFIG?.ai_text||""}}const aiPostRenderer=(()=>{let t;return()=>(t||(t=new AIPostRenderer,t.init()),t)})(),ai=aiPostRenderer();